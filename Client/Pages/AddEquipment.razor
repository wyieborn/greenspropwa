@page "/add-equipment"
@using GreensProPWA.Shared.Entity
@inject HttpClient Http

<h2 class="text-2xl font-bold text-gray-800 mb-4">Add New Equipment</h2>

<EditForm Model="equipment" OnValidSubmit="Submit">
    <DataAnnotationsValidator />
    <ValidationSummary />

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">

        <!-- Equipment Name -->
        <div class="md:col-span-2">
            <label class="block text-sm font-medium text-gray-700">Equipment Name</label>
            <InputText @bind-Value="equipment.Name" class="mt-1 block w-full border rounded p-2" />
        </div>

        <!-- Description (optional) -->
        <div class="md:col-span-2">
            <label class="block text-sm font-medium text-gray-700">Description (optional)</label>
            <InputTextArea @bind-Value="equipment.Description" class="mt-1 block w-full border rounded p-2 min-h-[80px]" />
        </div>

        <!-- Submit Button -->
        <div class="md:col-span-2">
            <button type="submit" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 transition">
                Save Equipment
            </button>
        </div>

        @if (showSuccess)
        {
            <div class="md:col-span-2 mt-4 bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded shadow">
                ✅ Equipment saved successfully!
            </div>
        }
    </div>
</EditForm>

@code {
    private Equipment equipment = new();
    private bool showSuccess = false;

    private async Task Submit()
    {
        var response = await Http.PostAsJsonAsync("api/equipment", equipment);

        if (response.IsSuccessStatusCode)
        {
            showSuccess = true;
            equipment = new();
        }
        else
        {
            Console.WriteLine("Failed to save equipment: " + response.StatusCode);
        }
    }

    public class Equipment
    {
        public int Id { get; set; }
        public string Name { get; set; } = string.Empty;
        public string? Description { get; set; }
    }
}
